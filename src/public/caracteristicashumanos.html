<!DOCTYPE html>
<html lang="es">
  <head>
    <!-- Meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <style>
      body {
        background-image: url("https://img.freepik.com/foto-gratis/tiro-angulo-viejos-pilares-piedra-griegos-cielo-azul-claro_181624-2890.jpg?w=1380&t=st=1706432288~exp=1706432888~hmac=8b8e9d2e18d58d2663f5aec20af01d302772af2ea1d4029507429faa2a3c676a");
        background-repeat: no-repeat;
        background-size: cover;
      }

      .form-group {
        background-color: rgba(255, 255, 255, 0.5);
        /* blanco con 50% de transparencia */
        padding: 20px;
        margin: 20px 0;
      }

      .form-control[readonly] {
        background-color: #e9ecef; /* color de fondo gris claro */
      }
    </style>
    <title>Características del humano</title>
  </head>

  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="#">Humanos</a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="./dashboardhumanovivo.html"
              >Resolver Pruebas</a
            >
          </li>
        </ul>
      </div>
    </nav>

    <div class="container">
      <h1 class="mt-4">Características del Humano</h1>

      <form>
        <div class="form-group">
          <label for="sabiduria">Sabiduría</label>
          <input
            type="number"
            class="form-control"
            id="sabiduria"
            name="sabiduria"
            min="1"
            max="5"
            readonly
          />
        </div>
        <div class="form-group">
          <label for="nobleza">Nobleza</label>
          <input
            type="number"
            class="form-control"
            id="nobleza"
            name="nobleza"
            min="1"
            max="5"
            readonly
          />
        </div>
        <div class="form-group">
          <label for="virtud">Virtud</label>
          <input
            type="number"
            class="form-control"
            id="virtud"
            name="virtud"
            min="1"
            max="5"
            readonly
          />
        </div>
        <div class="form-group">
          <label for="maldad">Maldad</label>
          <input
            type="number"
            class="form-control"
            id="maldad"
            name="maldad"
            min="1"
            max="5"
            readonly
          />
        </div>
        <div class="form-group">
          <label for="audacia">Audacia</label>
          <input
            type="number"
            class="form-control"
            id="audacia"
            name="audacia"
            min="1"
            max="5"
            readonly
          />
        </div>
        <div class="form-group">
          <label for="destino">Destino</label>
          <input
            type="text"
            class="form-control"
            id="destino"
            name="destino"
            readonly
          />
        </div>
      </form>

      <!-- Párrafo para mostrar datos en el DOM -->
      <p id="resultadoDom"></p>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script>
      // Función para cargar datos al cargar la página
      function cargarDatosUsuarios() {
        var token = sessionStorage.getItem("token");
        var id_humano = sessionStorage.getItem("id_humano");
        var vida = sessionStorage.getItem("vida");

        // URL de la API para obtener el destino
        var destinoUrl =
          "http://localhost:8000/api/humano/destino/" + id_humano;

        // Realiza la petición para obtener el destino
        fetch(destinoUrl, {
          method: "GET",
          headers: {
            Authorization: "Bearer " + token,
          },
        })
          .then((response) => response.json())
          .then((destinoData) => {
            // Imprime toda la respuesta de la API en la consola para depuración
            console.log(
              "Respuesta completa de la API de destino:",
              destinoData
            );

            // Verifica que la propiedad 'data' existe y no es undefined
            if (destinoData) {
              // Asigna el valor del destino al campo de input correspondiente
              document.getElementById("destino").value =
                destinoData.destino || "";
            } else {
              console.error(
                'Error: La propiedad "destino" no está presente en la respuesta de la API.'
              );
            }
          })
          .catch((error) => {
            console.error("Error al obtener el destino:", error);
          });

        // URL de la API para obtener las características del humano
        var apiUrl =
          "http://127.0.0.1:8000/api/humano/obtener/caracteristicas/" +
          id_humano;

        // Realiza la petición a la API para obtener las características del humano
        fetch(apiUrl, {
          method: "GET",
          headers: {
            Authorization: "Bearer " + token,
          },
        })
          .then((response) => response.json())
          .then((data) => {
            // Imprime toda la respuesta de la API en la consola para depuración
            console.log(
              "Respuesta completa de la API de características:",
              data
            );

            // Verifica que la propiedad 'data' existe y no es undefined
            if (data) {
              // Asigna los valores a los campos de input
              document.getElementById("sabiduria").value = data.sabiduria || "";
              document.getElementById("nobleza").value = data.nobleza || "";
              document.getElementById("virtud").value = data.virtud || "";
              document.getElementById("maldad").value = data.maldad || "";
              document.getElementById("audacia").value = data.audacia || "";

              // Cambiar el texto del enlace del navbar según el valor de vida
              var enlaceNavbar = document.querySelector(
                ".navbar-nav .nav-item a.nav-link"
              );
              if (vida && parseInt(vida) == 0) {
                enlaceNavbar.textContent = "Ver Resumen";
                enlaceNavbar.setAttribute("href", "dashboardhumanomuerto.html");
              } else {
                enlaceNavbar.textContent = "Resolver Pruebas";
                enlaceNavbar.setAttribute("href", "dashboardhumanovivo.html");
              }
            } else {
              console.error(
                'Error: La propiedad "data" no está presente en la respuesta de la API.'
              );
            }
          })
          .catch((error) => {
            console.error("Error al obtener las características:", error);
          });
      }

      // Cargar datos al cargar la página
      document.addEventListener("DOMContentLoaded", cargarDatosUsuarios);
    </script>
  </body>
</html>
